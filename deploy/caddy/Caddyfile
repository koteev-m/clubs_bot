# Global options
{
  # Enable compression globally
  encode zstd gzip
}

# NOTE:
# - В STAGE/PROD включайте этот серверный блок на HTTPS-хосте.
# - Для DEV можно держать отдельный Caddyfile без HSTS.

your.domain.com {
  reverse_proxy 127.0.0.1:8080

  # Безопасные заголовки (+ HSTS для HTTPS окружений)
  header {
    Strict-Transport-Security "max-age=31536000; includeSubDomains"
    Referrer-Policy "no-referrer"
    X-Content-Type-Options "nosniff"
    Permissions-Policy "camera=(), microphone=(), geolocation=()"
    -Server
  }

  # Иммутабельный кэш для статических ассетов WebApp
  @entry path /webapp/entry/*
  header @entry Cache-Control "public, max-age=31536000, immutable"
}
